<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>yaos by onkwon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">yaos</h1>
      <h2 class="project-tagline">Operating System for Internet of Things(IoT) devices</h2>
      <a href="https://github.com/onkwon/yaos" class="btn">View on GitHub</a>
      <a href="https://github.com/onkwon/yaos/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/onkwon/yaos/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="yaos" class="anchor" href="#yaos" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>yaos</h1>

<p>yaos is an embedded operating system for Internet of Things(IoT) devices, specifically for a single-core processor without MMU virtualization. It is designed for energy efficiency and hardware independent development.</p>

<p>Refer to <code>/Documentation</code> directory for more information such as compiling, porting, APIs, etc.</p>

<p>Any feedback is welcome to <em><a href="mailto:kwon@toanyone.net">kwon@toanyone.net</a></em>. And let me know if any of you are interested in porting to new MCU so that I can give you a hand.</p>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h2>

<h3>
<a id="1-download-yaos" class="anchor" href="#1-download-yaos" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. Download yaos</h3>

<p><code>git clone git://github.com/onkwon/yaos</code></p>

<h3>
<a id="2-get-a-toolchain" class="anchor" href="#2-get-a-toolchain" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. Get a Toolchain</h3>

<p>Get one from <a href="https://launchpad.net/gcc-arm-embedded">here</a> if you don't have one installed yet. Or you can compile it from source code putting more effort, which is not recommended but still worth trying.</p>

<h3>
<a id="3-build" class="anchor" href="#3-build" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. Build</h3>

<h4>
<a id="stm32" class="anchor" href="#stm32" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>STM32</h4>

<pre><code>make clean
make stm32f1 (or stm32f4)
make
make burn
</code></pre>

<blockquote>
<p>Tested on STM32F103 and STM32F407</p>
</blockquote>

<h4>
<a id="raspberry-pi2" class="anchor" href="#raspberry-pi2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Raspberry Pi(2)</h4>

<pre><code>make clean
make rpi (or rpi2)
make
</code></pre>

<p>That's it. Copy <code>yaos.bin</code> file into SD card as name of <code>kernel.img</code>, where <code>bootcode.bin</code> and <code>start.elf</code> files exist. Insert SD card in your RPI, turn it on, and enjoy!</p>

<blockquote>
<p>You can get the GPU firmware and bootloaders <a href="https://github.com/raspberrypi/firmware">here</a>.</p>
</blockquote>

<p>You will see shell prompt <code>&gt;</code> after some system log if uart rs232 cable connected.</p>

<p>Character LCD is also opened by default. You can change default pin assignment in <code>/mach/rpi/include/pinmap.h</code>. Pinout:</p>

<pre><code>          -----
+3V3 ----|1   2|--\
         |3   4|---- +5V0
         |5   6|---- GND
 DB7 ----|7   8|---- TXD0
         |9  10|---- RXD0
 DB6 ----|11 12|
 DB5 ----|13 14|
 DB4 ----|15 16|
         |17 18|
  E  ----|19 20|
  RW ----|21 22|
  RS ----|23 24|
         |25 26| ---- IR
          -----
</code></pre>

<blockquote>
<p>In case of getting error messages something like <code>undefined reference to __aeabi_uidiv</code>, specify library path when you <code>make</code> in the way below:</p>
</blockquote>

<pre><code>LD_LIBRARY_PATH=/usr/local/arm/lib/gcc/arm-none-eabi/4.9.2 make
</code></pre>

<blockquote>
<p>The path is dependent on your development environment.</p>
</blockquote>

<h2>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Features</h2>

<h3>
<a id="task-management-and-scheduling" class="anchor" href="#task-management-and-scheduling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Task management and scheduling</h3>

<p>Two types of task are handled: normal and real time tasks. Simplified fair scheduler for normal tasks while FIFO scheduler for real time tasks. Each task is given a priority which can be dynamically changed with <code>set_task_pri()</code>. For real time tasks a higher priority task always preempts lower priority tasks while the same priority tasks take place in turn under round-robin scheduling. Scheduler can be stopped to reduce even the scheduling overhead in case of a time critical task. On the other hand nomal tasks get chance to run by simplified fair scheduler, that picks the minimum value of vruntime up for the next task to run.</p>

<p>Tasks are always in one of five states: running, stopped, waiting, sleeping, or zombie. And a task can be created both statically and dynamically at run-time.</p>

<h3>
<a id="system-call-interface" class="anchor" href="#system-call-interface" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>System call interface</h3>

<p>System resource is accessed by the system call interface entering privileged mode as a user task runs in user(unpriviliged) mode.</p>

<h3>
<a id="virtual-file-system" class="anchor" href="#virtual-file-system" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Virtual file system</h3>

<p>The concept of virtual file system(VFS) is implemented. The embedded flash rom in SoC can be mounted as the root file system(embedfs) while a ramfs is mounted as a devfs for a device node.</p>

<h3>
<a id="memory-management" class="anchor" href="#memory-management" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Memory management</h3>

<p>Page is unit of memory management but alternative memory manager can be used in such a system of memory shortage.</p>

<p>Buddy allocator and first-fit allocator are implemented.</p>

<h3>
<a id="deferred-interrupt-servicing-softirq" class="anchor" href="#deferred-interrupt-servicing-softirq" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Deferred interrupt servicing (softirq)</h3>

<p>Softirqs will preempt any work except the response to a real interrupt as they run at a high priority. In fact softirq is just a kernel task running with interrupts enabled and can sleep but has the highest priority amongst running tasks.</p>

<h3>
<a id="synchronization" class="anchor" href="#synchronization" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Synchronization</h3>

<p>Synchronization primitives such as semaphore, spinlock, etc.</p>

<h3>
<a id="blocking--non-blocking-io-operations" class="anchor" href="#blocking--non-blocking-io-operations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Blocking &amp; non-blocking I/O operations</h3>

<h3>
<a id="device-driver" class="anchor" href="#device-driver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Device driver</h3>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/onkwon/yaos">yaos</a> is maintained by <a href="https://github.com/onkwon">onkwon</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
